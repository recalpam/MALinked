<script>
$(document).ready(function(){
isCalled = false;

// Messy jquery part no time to do it clean
    function readFile(file, part){
      if( isCalled ){
        isCalled = false;
        return;
      }
      isCalled = true;

      var reader = new FileReader();

      reader.onload = function (e) {
        var base64 = e.target.result;
        var regex = /^data:(.+?)\/(.+?);/i;
        var data = base64.match(regex);

        if( data[2] != 'png' && data[2] != 'jpg' && data[2] != 'jpeg' ){
          alert('Je mag alleen png of jpeg uploaden.');
          return;
        }
        var imageUrl = 'http://malinked.dev/api/db/previewimage?type=medium&image=';
        if( part == 'background' ){
          $('#'+part).css('background', 'url('+ imageUrl + base64 );
        } else {
          $('#'+part).attr('src', imageUrl + base64);
        }
      }

      reader.readAsDataURL(file);
    }


   $(document).on("change", '.speedyUpload', function(){
        files = $(this)[0].files;
        
        if (typeof window.FileReader === 'function') {
          for( var k = 0; k < files.length; k++ ){
            readFile(files[k], $(this).data('part'));
          }
        }
      });
});

</script>



<article class="hobbys-en-gegevens medium-9 columns content" ng-show="show">
  <form enctype="multipart/form-data" data-abide>
    <div class="row">
      <div class="small-12 columns">
        <h2>Voorbeeld van je profiel</h2>
        <div class="student grafisch-vormgever" style="background-image: url(http://placehold.it/1200x420);" id="background">
          <div class="info">
            <h4>{{ userData.fullname }}</h4>
            <p>{{ userData.group.name }}</p>
          </div>
          <figure>
            <img src="{{userData.file.medium}}" title="Huidige profiel foto" id="profilepicture">
          </figure>
        </div>
      </div>
    </div>
    <div class="row">
      <div class="small-12 medium-6 columns">
        <div class="avatar-field">
          <label>Persoonlijke foto wijzigen
            <div class="speedyUpload-container">
              <div class="input">Geen bestand geselecteerd</div>
              <input name="image" type="file" data-part="profilepicture" class="speedyUpload">
            </div>
            <small class="error">Upload een (geldige) afbeelding!</small>
          </label>
        </div>
      </div>
      <div class="small-12 medium-6 columns">
        <div class="profile-header-field">
          <label>Profiel Achtergrond
            <div class="speedyUpload-container">
              <div class="input">Geen bestand geselecteerd</div>
              <input name="image" type="file" data-part="background" class="speedyUpload">
            </div>
            <small class="error">Upload een (geldige) afbeelding!</small>
          </label>
        </div>
      </div>
    </div>
    <div class="row">
      <div class="small-12 medium-6 columns">
        <div class="email-field">
          <label>Persoonlijk e-mailadres
            <input name="email" type="text" placeholder="jaarboek@gmail.com" value="{{ userData.info.email }}" />
          </label>
        </div>
      </div>
      <div class="small-12 medium-6 columns">
        <div class="woonplaats-field">
          <label>Woonplaats
            <input name="city" type="text" placeholder="Amsterdam" value="{{ userData.info.location }}" required />
          </label>
          <small class="error">Vul je woonplaats in!</small>
        </div>
      </div>
    </div>
    <div class="row">
      <div class="small-12 medium-6 columns">
        <div class="portfolio-field">
          <label>Link naar portfolio website
            <div class="row collapse">
              <div class="small-3 columns">
                <span class="prefix">http://</span>
              </div>
              <div class="small-9 columns">
                <input name="portfolio" type="text" placeholder="www.mijnportfolio.nl" value="{{ userData.info.portfolio }}" pattern="^([a-zA-Z0-9]([a-zA-Z0-9\-]{0,61}[a-zA-Z0-9])?\.)+[a-zA-Z]{2,6}$">
              </div>
            </div>
          </label>
          <small class="error">Vul een geldige link in!</small>
        </div>
      </div>
      <div class="small-12 medium-6 columns">
        <div class="linkedin-field">
          <label>Link naar LinkedIn profiel
            <input name="linkedin" type="text" placeholder="https://linkedin.com/Gebruikersnaam" value="{{ userData.info.linkedin }}" pattern="linkedin\.com" />
          </label>
          <small class="error">Vul een geldige link in!</small>
        </div>
      </div>
    </div>
    <div class="row">
      <div class="small-12 medium-6 columns">
        <div class="dribbble-field">
          <label>Link naar Dribbble profiel
            <input name="dribbble" type="text" placeholder="https://dribbble.com/Gebruikersnaam" value="{{ userData.info.dribbble }}" pattern="dribbble\.com" />
          </label>
          <small class="error">Vul een geldige link in!</small>
        </div>
      </div>
      <div class="small-12 medium-6 columns">
        <div class="behance-field">
          <label>Link naar Behance profiel
            <input name="behance" type="text" placeholder="https://www.behance.net/Gebruikersnaam" value="{{ userData.info.behance }}" pattern="behance\.net" />
          </label>
          <small class="error">Vul een geldige link in!</small>
        </div>
      </div>
    </div>
    <div class="row">
      <div class="small-12 medium-6 columns">
        <div class="vimeo-field">
          <label>Link naar Vimeo profiel
            <input name="vimeo" type="text" placeholder="https://vimeo.com/Gebruikersnaam" value="{{ userData.info.vimeo }}" pattern="vimeo\.com" />
          </label>
          <small class="error">Vul een geldige link in!</small>
        </div>
      </div>
      <div class="small-12 medium-6 columns">
        <div class="youtube-field">
          <label>Link naar YouTube profiel
            <input name="youtube" type="text" placeholder="https://youtube.com/user/Gebruikersnaam" value="{{ userData.info.youtube }}" pattern="youtube\.com" />
          </label>
          <small class="error">Vul een geldige link in!</small>
        </div>
      </div>
    </div>
    <div class="row">
      <div class="small-12 medium-6 columns">
        <div class="facebook-field">
          <label>Link naar Facebook profiel
            <input name="facebook" type="text" placeholder="https://www.facebook.com/Gebruikersnaam" value="{{ userData.info.facebook }}" pattern="facebook\.com" />
          </label>
          <small class="error">Vul een geldige link in!</small>
        </div>
      </div>
      <div class="small-12 columns">
        <div class="hobby-field">
          <label>Interesses / hobby's<br>
            <small>Plaats hieronder je interesses/hobby's, meerdere interesses/hobby's kun je onderscheiden met een enter, komma of tab:</small>
            <input name="hobby" value="{{ getHobbies() }}" required>
          </label>
          <small class="error">Vul geldige interesses / hobby's in!</small>
        </div>
      </div>
    </div>
    <div class="row">
      <div class="small-12 columns">
        <hr>
      </div>
    </div>
    <div class="row text-right">
      <div class="small-12 columns">
        <a href="#" class="button">Herstel velden</a>
        <a href="#" class="button">Opslaan</a>
      </div>
    </div>
  </form>
</article>
<article class="waarom-het-ma medium-9 columns content" ng-hide="show">
  <center><img src="http://www.ajaxload.info/cache/FF/FF/FF/00/00/00/5-1.gif" alt="Loading..."/></center>
</article>